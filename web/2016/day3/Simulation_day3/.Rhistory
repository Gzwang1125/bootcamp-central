x=rnorm(1000)
hist(x)
x=rnorm(1000)
hist(x)
x=rnorm(1000)
hist(x)
pi
x=rnorm(1000, mean=2, sd=3)
hist(x)
hist(x,main="N(2,9)", xlab=Random Numbers)
hist(x,main="N(2,9)", xlab="Random Numbers")
x=rnorm(1000)
hist(x)
hist(x,main="N(2,9)", xlab="Random Numbers")
pheno=rnorm(20)
pheno=rnorm(20)
hist(pheno,main="Pheno", xlab="Phenotypic Scores", nclass=5)
nsample=20
pheno=rnorm(nsample)
hist(pheno,main="Pheno", xlab="Phenotypic Scores", nclass=5)
nsample=20
pheno=rnorm(nsample)
hist(pheno,main="Pheno", xlab="Phenotypic Scores")
x=rnorm(1000)
hist(x,main="N(2,9)", xlab="Random Numbers", nclass=50)
nsample=20
pheno=rnorm(nsample)
hist(pheno,main="Pheno", xlab="Phenotypic Scores")
ngene=1000
genes=matrix(rnorm(nsamp*ngene),ncol=nsamp)
ngene=1000
genes=matrix(rnorm(nsamp*ngene),ncol=nsample)
ngene=1000
genes=matrix(rnorm(nsample*ngene),ncol=nsample)
cors=cor(t(genes),pheno)
hist(cors,nclass=50,xlab="Correlations",main="Correlation between Gene Expression and Phenotype")
nsel=10
selgenes=order(cors,decreasing=FALSE)[1:nsel]
sigGenes=genes[selgenes,]
regout=lm(pheno~t(sigGenes))
R2=var(fitted(regout))/var(pheno)
anova(regout)
R2
cors=cor(t(genes),pheno)
cors[1:5,1:5]
cors=cor(t(genes),pheno)
cors[1:5,]
cors=cor(t(genes),pheno)
cors[1:5,1:2]
cors=cor(t(genes),pheno)
cors[1:2,1:2]
cors=cor(t(genes),pheno)
cors[1:2,1:2]
rnorm(1)
Random.seed()
set.seed(2016)
rnorm(1)
set.seed(2016)
rnorm(1)
.Random.seed=myseed
myseed=rnorm(100)
.Random.seed=myseed
myseed=rnorm(1)
.Random.seed=myseed
norm(1)
fnname=function(par1, par2)
code
fnname
mean=5
mean
y=rnorm(2)
.Random.seed=2
ynorm(2)
y=rnorm(2)
y
mean(y)
rm(.Random.seed)
y=rnorm(2)
y
SimR2=function(nsample=20, ngene=1000,nsel=10){}
SimR2=function(nsample=20, ngene=1000,nsel=10){
if (nsel >= nsample-1) stop("Must be less")
pheno=rnorm(nsample)
genes=matrix(rnorm(nsample*ngene),ncol=nsamp)
cors=cor(t(genes),pheno)
selgenes=order(cors,devreasing=TRUE)[1:nsel]
sigGenes=genes[selgenes,]
R2=var(fitted(lm(pheno~t(sigGenes)))/var(pheno)
c(maxAbsR=max(abs(cors)),minR=min(cors),maxR=max(cors),Rsq=R2)
SimR2=function(nsample=20, ngene=1000,nsel=10){
+ if (nsel >= nsample-1) stop("Must be less")
+ pheno=rnorm(nsample)
+ genes=matrix(rnorm(nsample*ngene),ncol=nsamp)
+ cors=cor(t(genes),pheno)
+ selgenes=order(cors,devreasing=TRUE)[1:nsel]
+ sigGenes=genes[selgenes,]
+ R2=var(fitted(lm(pheno~t(sigGenes)))/var(pheno)
+ c(maxAbsR=max(abs(cors)),minR=min(cors),maxR=max(cors),Rsq=R2)}
SimR2=function(nsample=20, ngene=1000,nsel=10){
+ if (nsel >= nsample-1) stop("Must be less")
+ pheno=rnorm(nsample)
+ genes=matrix(rnorm(nsample*ngene),ncol=nsamp)
+ cors=cor(t(genes),pheno)
+ selgenes=order(cors,devreasing=TRUE)[1:nsel]
+ sigGenes=genes[selgenes,]
+ R2=var(fitted(lm(pheno~t(sigGenes)))/var(pheno)
+ c(maxAbsR=max(abs(cors)),minR=min(cors),maxR=max(cors),Rsq=R2)
}
simR2=function(nsamp=20,ngene=1000,nsel=10){
if (nsel >= nsamp-1) stop("The number of genes selected must
be less than the sample size")
pheno=rnorm(nsamp)
genes=matrix(rnorm(nsamp*ngene),ncol=nsamp)
cors=cor(t(genes),pheno)
selgenes=order(cors,decreasing=TRUE)[1:nsel]
sigGenes=genes[selgenes,]
R2=var(fitted(lm(pheno~t(sigGenes))))/var(pheno)
c(maxAbsR=max(abs(cors)),minR=min(cors),maxR=max(cors),Rsq=R2)
}
simR2=function(nsamp=20,ngene=1000,nsel=10){
if (nsel >= nsamp-1) stop("The number of genes selected must
be less than the sample size")
pheno=rnorm(nsample)
genes=matrix(rnorm(nsample*ngene),ncol=nsample)
cors=cor(t(genes),pheno)
selgenes=order(cors,decreasing=TRUE)[1:nsel]
sigGenes=genes[selgenes,]
R2=var(fitted(lm(pheno~t(sigGenes))))/var(pheno)
c(maxAbsR=max(abs(cors)),minR=min(cors),maxR=max(cors),Rsq=R2)
}
simN20G1000S10=matrix(nrow=1000,ncol=4)
for (i in 1:1000) simN20G1000S10[i,]=simR2(nsamp=20,ngene=1000,nsel=10)
par(mfrow=c(2,2))
hist(simN20G1000S10[,1], nclass=50,main="Distribution of Largest Absolute Correlation",xlab="Maximum Absolute Correlation")
hist(simN20G1000S10[,2], nclass=50,main="Distribution of Smallest Correlation",xlab="Minimum Correlation")
hist(simN20G1000S10[,3], nclass=50,main="Distribution of Largest Correlation",xlab="Maximum Correlation")
hist(simN20G1000S10[,4], nclass=50,main="Distribution of R-square of Selected Genes",xlab="R-square")
samp=sample(1:12,12,replace=TRUE)
samp
par(mfrow=c(2,2))
hist(rpois(1000,.25),main="mean=0.25")
hist(rpois(1000,1),main="mean=1")
hist(rpois(1000,10),main="mean=10")
hist(rpois(100,50),main="mean=50")
